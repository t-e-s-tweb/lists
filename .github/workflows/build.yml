name: Build and Release

on:
  workflow_dispatch:
jobs:
  ubuntu-build:
    runs-on: ubuntu-latest
    container: docker.io/ubuntu:18.04
    steps:
      - name: Set up Go
        uses: actions/setup-go@v4
        with:
          go-version: '1.20'
          check-latest: true

      - name: Get project dependencies
        run: |
            apt update
            apt install -y ca-certificates

      - name: Build
        run: |
            go install -v -tags with_gvisor,with_quic,with_dhcp,with_wireguard,with_utls,with_reality_server,with_acme github.com/sagernet/sing-box/cmd/sing-box@latest
            echo pwd
            ls 
            echo $GOBIN
            ls $GOBIN
            echo $GOPATH/bin
            ls $GOPATH/bin

    #   - name: Upload binaries to release
    #     uses: svenstaro/upload-release-action@v2
    #     with:
    #       repo_token: ${{ secrets.PAT }}
    #       file: ./build_assets/caddy*
    #       tag: ${{ github.ref }}
    #       overwrite: true
    #       file_glob: true
    #       repo_name: purepoorx/caddy

